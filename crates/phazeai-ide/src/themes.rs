use egui::Color32;

#[derive(Clone, Debug, PartialEq)]
pub enum ThemePreset {
    Dark,
    TokyoNight,
    Dracula,
    Nord,
    OneDark,
    Monokai,
    SolarizedDark,
    GruvboxDark,
    CatppuccinMocha,
    Cyberpunk,
    Matrix,
    Light,
    SolarizedLight,
    GruvboxLight,
    CatppuccinLatte,
    GitHubLight,
    HighContrastDark,
    HighContrastLight,
    SpectralPurple,
    MidnightBlue,
    TokyoNightStorm,
    TokyoNightDay,
}

impl ThemePreset {
    pub fn name(&self) -> &'static str {
        match self {
            Self::Dark => "Dark",
            Self::TokyoNight => "Tokyo Night",
            Self::TokyoNightStorm => "Tokyo Night Storm",
            Self::Dracula => "Dracula",
            Self::Nord => "Nord",
            Self::OneDark => "One Dark",
            Self::Monokai => "Monokai",
            Self::SolarizedDark => "Solarized Dark",
            Self::GruvboxDark => "Gruvbox Dark",
            Self::CatppuccinMocha => "Catppuccin Mocha",
            Self::SpectralPurple => "Spectral Purple",
            Self::MidnightBlue => "Midnight Blue",
            Self::Cyberpunk => "Cyberpunk",
            Self::Matrix => "Matrix",
            Self::Light => "Light",
            Self::TokyoNightDay => "Tokyo Night Day",
            Self::SolarizedLight => "Solarized Light",
            Self::GruvboxLight => "Gruvbox Light",
            Self::CatppuccinLatte => "Catppuccin Latte",
            Self::GitHubLight => "GitHub Light",
            Self::HighContrastDark => "High Contrast Dark",
            Self::HighContrastLight => "High Contrast Light",
        }
    }

    pub fn all() -> Vec<Self> {
        vec![
            Self::Dark, Self::TokyoNight, Self::TokyoNightStorm, Self::Dracula,
            Self::Nord, Self::OneDark, Self::Monokai, Self::SolarizedDark,
            Self::GruvboxDark, Self::CatppuccinMocha, Self::SpectralPurple,
            Self::MidnightBlue, Self::Cyberpunk, Self::Matrix,
            Self::Light, Self::TokyoNightDay, Self::SolarizedLight,
            Self::GruvboxLight, Self::CatppuccinLatte, Self::GitHubLight,
            Self::HighContrastDark, Self::HighContrastLight,
        ]
    }
}

#[allow(dead_code)]
#[derive(Clone)]
pub struct ThemeColors {
    pub background: Color32,
    pub background_secondary: Color32,
    pub surface: Color32,
    pub panel: Color32,
    pub text: Color32,
    pub text_secondary: Color32,
    pub text_muted: Color32,
    pub accent: Color32,
    pub accent_hover: Color32,
    pub success: Color32,
    pub warning: Color32,
    pub error: Color32,
    pub border: Color32,
    pub selection: Color32,
    // Syntax
    pub keyword: Color32,
    pub string: Color32,
    pub comment: Color32,
    pub function: Color32,
    pub number: Color32,
    pub type_name: Color32,
}

impl ThemeColors {
    pub fn from_preset(preset: &ThemePreset) -> Self {
        match preset {
            ThemePreset::Dark => Self {
                background: Color32::from_rgb(30, 30, 30),
                background_secondary: Color32::from_rgb(37, 37, 37),
                surface: Color32::from_rgb(50, 50, 50),
                panel: Color32::from_rgb(42, 42, 42),
                text: Color32::from_rgb(220, 220, 220),
                text_secondary: Color32::from_rgb(180, 180, 180),
                text_muted: Color32::from_rgb(120, 120, 120),
                accent: Color32::from_rgb(0, 122, 255),
                accent_hover: Color32::from_rgb(0, 100, 200),
                success: Color32::from_rgb(76, 175, 80),
                warning: Color32::from_rgb(255, 152, 0),
                error: Color32::from_rgb(244, 67, 54),
                border: Color32::from_rgb(60, 60, 60),
                selection: Color32::from_rgba_premultiplied(0, 122, 255, 100),
                keyword: Color32::from_rgb(197, 134, 192),
                string: Color32::from_rgb(206, 145, 120),
                comment: Color32::from_rgb(106, 153, 85),
                function: Color32::from_rgb(220, 220, 170),
                number: Color32::from_rgb(181, 206, 168),
                type_name: Color32::from_rgb(78, 201, 176),
            },
            ThemePreset::TokyoNight | ThemePreset::TokyoNightStorm => Self {
                background: Color32::from_rgb(26, 27, 38),
                background_secondary: Color32::from_rgb(31, 32, 45),
                surface: Color32::from_rgb(41, 42, 58),
                panel: Color32::from_rgb(33, 34, 48),
                text: Color32::from_rgb(169, 177, 214),
                text_secondary: Color32::from_rgb(130, 139, 184),
                text_muted: Color32::from_rgb(86, 95, 137),
                accent: Color32::from_rgb(122, 162, 247),
                accent_hover: Color32::from_rgb(95, 135, 220),
                success: Color32::from_rgb(158, 206, 106),
                warning: Color32::from_rgb(224, 175, 104),
                error: Color32::from_rgb(247, 118, 142),
                border: Color32::from_rgb(52, 53, 74),
                selection: Color32::from_rgba_premultiplied(122, 162, 247, 100),
                keyword: Color32::from_rgb(187, 154, 247),
                string: Color32::from_rgb(158, 206, 106),
                comment: Color32::from_rgb(86, 95, 137),
                function: Color32::from_rgb(122, 162, 247),
                number: Color32::from_rgb(255, 199, 119),
                type_name: Color32::from_rgb(54, 206, 193),
            },
            ThemePreset::Dracula => Self {
                background: Color32::from_rgb(40, 42, 54),
                background_secondary: Color32::from_rgb(48, 50, 64),
                surface: Color32::from_rgb(68, 71, 90),
                panel: Color32::from_rgb(52, 55, 70),
                text: Color32::from_rgb(248, 248, 242),
                text_secondary: Color32::from_rgb(180, 180, 180),
                text_muted: Color32::from_rgb(98, 114, 164),
                accent: Color32::from_rgb(255, 121, 198),
                accent_hover: Color32::from_rgb(255, 89, 178),
                success: Color32::from_rgb(80, 250, 123),
                warning: Color32::from_rgb(241, 250, 140),
                error: Color32::from_rgb(255, 85, 85),
                border: Color32::from_rgb(68, 71, 90),
                selection: Color32::from_rgba_premultiplied(68, 71, 90, 150),
                keyword: Color32::from_rgb(255, 121, 198),
                string: Color32::from_rgb(241, 250, 140),
                comment: Color32::from_rgb(98, 114, 164),
                function: Color32::from_rgb(189, 147, 249),
                number: Color32::from_rgb(255, 184, 108),
                type_name: Color32::from_rgb(139, 233, 253),
            },
            ThemePreset::Nord => Self {
                background: Color32::from_rgb(46, 52, 64),
                background_secondary: Color32::from_rgb(59, 66, 82),
                surface: Color32::from_rgb(67, 76, 94),
                panel: Color32::from_rgb(59, 66, 82),
                text: Color32::from_rgb(216, 222, 233),
                text_secondary: Color32::from_rgb(180, 190, 210),
                text_muted: Color32::from_rgb(120, 135, 160),
                accent: Color32::from_rgb(136, 192, 208),
                accent_hover: Color32::from_rgb(129, 161, 193),
                success: Color32::from_rgb(163, 190, 140),
                warning: Color32::from_rgb(235, 203, 139),
                error: Color32::from_rgb(191, 97, 106),
                border: Color32::from_rgb(76, 86, 106),
                selection: Color32::from_rgba_premultiplied(136, 192, 208, 80),
                keyword: Color32::from_rgb(180, 142, 173),
                string: Color32::from_rgb(163, 190, 140),
                comment: Color32::from_rgb(97, 110, 136),
                function: Color32::from_rgb(136, 192, 208),
                number: Color32::from_rgb(180, 142, 173),
                type_name: Color32::from_rgb(143, 188, 187),
            },
            ThemePreset::OneDark => Self {
                background: Color32::from_rgb(40, 44, 52),
                background_secondary: Color32::from_rgb(50, 54, 62),
                surface: Color32::from_rgb(62, 68, 81),
                panel: Color32::from_rgb(48, 52, 61),
                text: Color32::from_rgb(171, 178, 191),
                text_secondary: Color32::from_rgb(140, 148, 165),
                text_muted: Color32::from_rgb(92, 99, 112),
                accent: Color32::from_rgb(97, 175, 239),
                accent_hover: Color32::from_rgb(75, 150, 215),
                success: Color32::from_rgb(152, 195, 121),
                warning: Color32::from_rgb(229, 192, 123),
                error: Color32::from_rgb(224, 108, 117),
                border: Color32::from_rgb(60, 65, 75),
                selection: Color32::from_rgba_premultiplied(97, 175, 239, 80),
                keyword: Color32::from_rgb(198, 120, 221),
                string: Color32::from_rgb(152, 195, 121),
                comment: Color32::from_rgb(92, 99, 112),
                function: Color32::from_rgb(97, 175, 239),
                number: Color32::from_rgb(209, 154, 102),
                type_name: Color32::from_rgb(86, 182, 194),
            },
            ThemePreset::Monokai => Self {
                background: Color32::from_rgb(39, 40, 34),
                background_secondary: Color32::from_rgb(49, 50, 44),
                surface: Color32::from_rgb(62, 63, 55),
                panel: Color32::from_rgb(52, 53, 46),
                text: Color32::from_rgb(248, 248, 242),
                text_secondary: Color32::from_rgb(200, 200, 195),
                text_muted: Color32::from_rgb(117, 113, 94),
                accent: Color32::from_rgb(102, 217, 239),
                accent_hover: Color32::from_rgb(80, 190, 210),
                success: Color32::from_rgb(166, 226, 46),
                warning: Color32::from_rgb(253, 151, 31),
                error: Color32::from_rgb(249, 38, 114),
                border: Color32::from_rgb(72, 73, 63),
                selection: Color32::from_rgba_premultiplied(102, 217, 239, 70),
                keyword: Color32::from_rgb(249, 38, 114),
                string: Color32::from_rgb(230, 219, 116),
                comment: Color32::from_rgb(117, 113, 94),
                function: Color32::from_rgb(166, 226, 46),
                number: Color32::from_rgb(174, 129, 255),
                type_name: Color32::from_rgb(102, 217, 239),
            },
            ThemePreset::SolarizedDark => Self {
                background: Color32::from_rgb(0, 43, 54),
                background_secondary: Color32::from_rgb(7, 54, 66),
                surface: Color32::from_rgb(7, 54, 66),
                panel: Color32::from_rgb(0, 43, 54),
                text: Color32::from_rgb(131, 148, 150),
                text_secondary: Color32::from_rgb(108, 125, 130),
                text_muted: Color32::from_rgb(88, 110, 117),
                accent: Color32::from_rgb(38, 139, 210),
                accent_hover: Color32::from_rgb(30, 120, 190),
                success: Color32::from_rgb(133, 153, 0),
                warning: Color32::from_rgb(181, 137, 0),
                error: Color32::from_rgb(220, 50, 47),
                border: Color32::from_rgb(7, 54, 66),
                selection: Color32::from_rgba_premultiplied(38, 139, 210, 80),
                keyword: Color32::from_rgb(133, 153, 0),
                string: Color32::from_rgb(42, 161, 152),
                comment: Color32::from_rgb(88, 110, 117),
                function: Color32::from_rgb(38, 139, 210),
                number: Color32::from_rgb(211, 54, 130),
                type_name: Color32::from_rgb(181, 137, 0),
            },
            ThemePreset::GruvboxDark => Self {
                background: Color32::from_rgb(40, 40, 40),
                background_secondary: Color32::from_rgb(50, 48, 47),
                surface: Color32::from_rgb(60, 56, 54),
                panel: Color32::from_rgb(50, 48, 47),
                text: Color32::from_rgb(235, 219, 178),
                text_secondary: Color32::from_rgb(189, 174, 147),
                text_muted: Color32::from_rgb(146, 131, 116),
                accent: Color32::from_rgb(69, 133, 136),
                accent_hover: Color32::from_rgb(55, 115, 120),
                success: Color32::from_rgb(152, 151, 26),
                warning: Color32::from_rgb(250, 189, 47),
                error: Color32::from_rgb(204, 36, 29),
                border: Color32::from_rgb(80, 73, 69),
                selection: Color32::from_rgba_premultiplied(69, 133, 136, 90),
                keyword: Color32::from_rgb(204, 36, 29),
                string: Color32::from_rgb(152, 151, 26),
                comment: Color32::from_rgb(146, 131, 116),
                function: Color32::from_rgb(69, 133, 136),
                number: Color32::from_rgb(211, 134, 155),
                type_name: Color32::from_rgb(250, 189, 47),
            },
            ThemePreset::CatppuccinMocha => Self {
                background: Color32::from_rgb(30, 30, 46),
                background_secondary: Color32::from_rgb(36, 36, 54),
                surface: Color32::from_rgb(49, 50, 68),
                panel: Color32::from_rgb(36, 36, 54),
                text: Color32::from_rgb(205, 214, 244),
                text_secondary: Color32::from_rgb(166, 173, 200),
                text_muted: Color32::from_rgb(108, 112, 134),
                accent: Color32::from_rgb(137, 180, 250),
                accent_hover: Color32::from_rgb(116, 160, 235),
                success: Color32::from_rgb(166, 227, 161),
                warning: Color32::from_rgb(249, 226, 175),
                error: Color32::from_rgb(243, 139, 168),
                border: Color32::from_rgb(69, 71, 90),
                selection: Color32::from_rgba_premultiplied(137, 180, 250, 80),
                keyword: Color32::from_rgb(203, 166, 247),
                string: Color32::from_rgb(166, 227, 161),
                comment: Color32::from_rgb(108, 112, 134),
                function: Color32::from_rgb(137, 180, 250),
                number: Color32::from_rgb(250, 179, 135),
                type_name: Color32::from_rgb(249, 226, 175),
            },
            ThemePreset::Cyberpunk => Self {
                background: Color32::from_rgb(13, 2, 33),
                background_secondary: Color32::from_rgb(22, 8, 48),
                surface: Color32::from_rgb(35, 15, 65),
                panel: Color32::from_rgb(22, 8, 48),
                text: Color32::from_rgb(0, 255, 255),
                text_secondary: Color32::from_rgb(0, 200, 200),
                text_muted: Color32::from_rgb(100, 100, 180),
                accent: Color32::from_rgb(255, 0, 255),
                accent_hover: Color32::from_rgb(200, 0, 200),
                success: Color32::from_rgb(0, 255, 100),
                warning: Color32::from_rgb(255, 255, 0),
                error: Color32::from_rgb(255, 50, 50),
                border: Color32::from_rgb(80, 0, 120),
                selection: Color32::from_rgba_premultiplied(255, 0, 255, 70),
                keyword: Color32::from_rgb(255, 0, 255),
                string: Color32::from_rgb(0, 255, 180),
                comment: Color32::from_rgb(100, 100, 180),
                function: Color32::from_rgb(0, 200, 255),
                number: Color32::from_rgb(255, 255, 0),
                type_name: Color32::from_rgb(255, 100, 200),
            },
            ThemePreset::Matrix => Self {
                background: Color32::from_rgb(0, 10, 0),
                background_secondary: Color32::from_rgb(0, 18, 0),
                surface: Color32::from_rgb(0, 28, 0),
                panel: Color32::from_rgb(0, 18, 0),
                text: Color32::from_rgb(0, 255, 65),
                text_secondary: Color32::from_rgb(0, 200, 50),
                text_muted: Color32::from_rgb(0, 120, 30),
                accent: Color32::from_rgb(0, 255, 65),
                accent_hover: Color32::from_rgb(0, 200, 50),
                success: Color32::from_rgb(0, 255, 100),
                warning: Color32::from_rgb(100, 255, 0),
                error: Color32::from_rgb(255, 0, 0),
                border: Color32::from_rgb(0, 60, 0),
                selection: Color32::from_rgba_premultiplied(0, 255, 65, 50),
                keyword: Color32::from_rgb(0, 255, 120),
                string: Color32::from_rgb(100, 255, 0),
                comment: Color32::from_rgb(0, 100, 25),
                function: Color32::from_rgb(0, 255, 200),
                number: Color32::from_rgb(0, 200, 255),
                type_name: Color32::from_rgb(150, 255, 0),
            },
            ThemePreset::Light => Self {
                background: Color32::from_rgb(255, 255, 255),
                background_secondary: Color32::from_rgb(245, 245, 245),
                surface: Color32::from_rgb(235, 235, 235),
                panel: Color32::from_rgb(245, 245, 245),
                text: Color32::from_rgb(36, 36, 36),
                text_secondary: Color32::from_rgb(80, 80, 80),
                text_muted: Color32::from_rgb(150, 150, 150),
                accent: Color32::from_rgb(0, 122, 255),
                accent_hover: Color32::from_rgb(0, 100, 210),
                success: Color32::from_rgb(40, 167, 69),
                warning: Color32::from_rgb(255, 152, 0),
                error: Color32::from_rgb(220, 53, 69),
                border: Color32::from_rgb(218, 218, 218),
                selection: Color32::from_rgba_premultiplied(0, 122, 255, 60),
                keyword: Color32::from_rgb(175, 0, 219),
                string: Color32::from_rgb(163, 21, 21),
                comment: Color32::from_rgb(0, 128, 0),
                function: Color32::from_rgb(121, 94, 38),
                number: Color32::from_rgb(9, 134, 88),
                type_name: Color32::from_rgb(38, 127, 153),
            },
            ThemePreset::TokyoNightDay => Self {
                background: Color32::from_rgb(212, 216, 232),
                background_secondary: Color32::from_rgb(200, 205, 225),
                surface: Color32::from_rgb(190, 196, 218),
                panel: Color32::from_rgb(200, 205, 225),
                text: Color32::from_rgb(52, 59, 88),
                text_secondary: Color32::from_rgb(75, 82, 115),
                text_muted: Color32::from_rgb(130, 138, 170),
                accent: Color32::from_rgb(52, 84, 209),
                accent_hover: Color32::from_rgb(40, 70, 185),
                success: Color32::from_rgb(56, 124, 68),
                warning: Color32::from_rgb(143, 116, 50),
                error: Color32::from_rgb(196, 57, 75),
                border: Color32::from_rgb(178, 185, 210),
                selection: Color32::from_rgba_premultiplied(52, 84, 209, 60),
                keyword: Color32::from_rgb(118, 80, 169),
                string: Color32::from_rgb(89, 120, 46),
                comment: Color32::from_rgb(148, 155, 183),
                function: Color32::from_rgb(52, 84, 209),
                number: Color32::from_rgb(150, 92, 37),
                type_name: Color32::from_rgb(7, 135, 144),
            },
            ThemePreset::SolarizedLight => Self {
                background: Color32::from_rgb(253, 246, 227),
                background_secondary: Color32::from_rgb(238, 232, 213),
                surface: Color32::from_rgb(238, 232, 213),
                panel: Color32::from_rgb(253, 246, 227),
                text: Color32::from_rgb(101, 123, 131),
                text_secondary: Color32::from_rgb(88, 110, 117),
                text_muted: Color32::from_rgb(147, 161, 161),
                accent: Color32::from_rgb(38, 139, 210),
                accent_hover: Color32::from_rgb(30, 120, 190),
                success: Color32::from_rgb(133, 153, 0),
                warning: Color32::from_rgb(181, 137, 0),
                error: Color32::from_rgb(220, 50, 47),
                border: Color32::from_rgb(214, 207, 187),
                selection: Color32::from_rgba_premultiplied(38, 139, 210, 60),
                keyword: Color32::from_rgb(133, 153, 0),
                string: Color32::from_rgb(42, 161, 152),
                comment: Color32::from_rgb(147, 161, 161),
                function: Color32::from_rgb(38, 139, 210),
                number: Color32::from_rgb(211, 54, 130),
                type_name: Color32::from_rgb(181, 137, 0),
            },
            ThemePreset::GruvboxLight => Self {
                background: Color32::from_rgb(251, 241, 199),
                background_secondary: Color32::from_rgb(235, 219, 178),
                surface: Color32::from_rgb(213, 196, 161),
                panel: Color32::from_rgb(235, 219, 178),
                text: Color32::from_rgb(60, 56, 54),
                text_secondary: Color32::from_rgb(80, 73, 69),
                text_muted: Color32::from_rgb(146, 131, 116),
                accent: Color32::from_rgb(7, 102, 120),
                accent_hover: Color32::from_rgb(5, 85, 100),
                success: Color32::from_rgb(121, 116, 14),
                warning: Color32::from_rgb(215, 153, 33),
                error: Color32::from_rgb(157, 0, 6),
                border: Color32::from_rgb(213, 196, 161),
                selection: Color32::from_rgba_premultiplied(7, 102, 120, 60),
                keyword: Color32::from_rgb(157, 0, 6),
                string: Color32::from_rgb(121, 116, 14),
                comment: Color32::from_rgb(146, 131, 116),
                function: Color32::from_rgb(7, 102, 120),
                number: Color32::from_rgb(143, 63, 113),
                type_name: Color32::from_rgb(215, 153, 33),
            },
            ThemePreset::CatppuccinLatte => Self {
                background: Color32::from_rgb(239, 241, 245),
                background_secondary: Color32::from_rgb(230, 233, 239),
                surface: Color32::from_rgb(220, 224, 232),
                panel: Color32::from_rgb(230, 233, 239),
                text: Color32::from_rgb(76, 79, 105),
                text_secondary: Color32::from_rgb(92, 95, 119),
                text_muted: Color32::from_rgb(140, 143, 161),
                accent: Color32::from_rgb(30, 102, 245),
                accent_hover: Color32::from_rgb(25, 85, 210),
                success: Color32::from_rgb(64, 160, 43),
                warning: Color32::from_rgb(223, 142, 29),
                error: Color32::from_rgb(210, 15, 57),
                border: Color32::from_rgb(204, 208, 218),
                selection: Color32::from_rgba_premultiplied(30, 102, 245, 60),
                keyword: Color32::from_rgb(136, 57, 239),
                string: Color32::from_rgb(64, 160, 43),
                comment: Color32::from_rgb(140, 143, 161),
                function: Color32::from_rgb(30, 102, 245),
                number: Color32::from_rgb(254, 100, 11),
                type_name: Color32::from_rgb(223, 142, 29),
            },
            ThemePreset::GitHubLight => Self {
                background: Color32::from_rgb(255, 255, 255),
                background_secondary: Color32::from_rgb(246, 248, 250),
                surface: Color32::from_rgb(234, 238, 242),
                panel: Color32::from_rgb(246, 248, 250),
                text: Color32::from_rgb(36, 41, 47),
                text_secondary: Color32::from_rgb(87, 96, 106),
                text_muted: Color32::from_rgb(140, 149, 159),
                accent: Color32::from_rgb(9, 105, 218),
                accent_hover: Color32::from_rgb(7, 90, 195),
                success: Color32::from_rgb(26, 127, 55),
                warning: Color32::from_rgb(191, 135, 0),
                error: Color32::from_rgb(207, 34, 46),
                border: Color32::from_rgb(216, 222, 228),
                selection: Color32::from_rgba_premultiplied(9, 105, 218, 50),
                keyword: Color32::from_rgb(207, 34, 46),
                string: Color32::from_rgb(10, 48, 105),
                comment: Color32::from_rgb(110, 119, 129),
                function: Color32::from_rgb(130, 80, 223),
                number: Color32::from_rgb(5, 80, 174),
                type_name: Color32::from_rgb(191, 135, 0),
            },
            ThemePreset::HighContrastDark => Self {
                background: Color32::from_rgb(0, 0, 0),
                background_secondary: Color32::from_rgb(15, 15, 15),
                surface: Color32::from_rgb(30, 30, 30),
                panel: Color32::from_rgb(15, 15, 15),
                text: Color32::from_rgb(255, 255, 255),
                text_secondary: Color32::from_rgb(230, 230, 230),
                text_muted: Color32::from_rgb(160, 160, 160),
                accent: Color32::from_rgb(0, 180, 255),
                accent_hover: Color32::from_rgb(0, 150, 220),
                success: Color32::from_rgb(0, 255, 0),
                warning: Color32::from_rgb(255, 255, 0),
                error: Color32::from_rgb(255, 0, 0),
                border: Color32::from_rgb(100, 100, 100),
                selection: Color32::from_rgba_premultiplied(0, 180, 255, 80),
                keyword: Color32::from_rgb(255, 120, 255),
                string: Color32::from_rgb(0, 255, 128),
                comment: Color32::from_rgb(160, 160, 160),
                function: Color32::from_rgb(100, 200, 255),
                number: Color32::from_rgb(255, 200, 0),
                type_name: Color32::from_rgb(0, 255, 255),
            },
            ThemePreset::HighContrastLight => Self {
                background: Color32::from_rgb(255, 255, 255),
                background_secondary: Color32::from_rgb(240, 240, 240),
                surface: Color32::from_rgb(225, 225, 225),
                panel: Color32::from_rgb(240, 240, 240),
                text: Color32::from_rgb(0, 0, 0),
                text_secondary: Color32::from_rgb(30, 30, 30),
                text_muted: Color32::from_rgb(100, 100, 100),
                accent: Color32::from_rgb(0, 0, 200),
                accent_hover: Color32::from_rgb(0, 0, 160),
                success: Color32::from_rgb(0, 128, 0),
                warning: Color32::from_rgb(200, 150, 0),
                error: Color32::from_rgb(200, 0, 0),
                border: Color32::from_rgb(150, 150, 150),
                selection: Color32::from_rgba_premultiplied(0, 0, 200, 60),
                keyword: Color32::from_rgb(160, 0, 160),
                string: Color32::from_rgb(0, 128, 0),
                comment: Color32::from_rgb(100, 100, 100),
                function: Color32::from_rgb(0, 0, 200),
                number: Color32::from_rgb(200, 100, 0),
                type_name: Color32::from_rgb(0, 100, 150),
            },
            ThemePreset::SpectralPurple => Self {
                background: Color32::from_rgb(25, 15, 40),
                background_secondary: Color32::from_rgb(35, 22, 55),
                surface: Color32::from_rgb(50, 32, 72),
                panel: Color32::from_rgb(35, 22, 55),
                text: Color32::from_rgb(220, 210, 240),
                text_secondary: Color32::from_rgb(180, 170, 210),
                text_muted: Color32::from_rgb(120, 105, 160),
                accent: Color32::from_rgb(180, 120, 255),
                accent_hover: Color32::from_rgb(150, 95, 225),
                success: Color32::from_rgb(130, 220, 150),
                warning: Color32::from_rgb(255, 200, 100),
                error: Color32::from_rgb(255, 100, 130),
                border: Color32::from_rgb(70, 50, 100),
                selection: Color32::from_rgba_premultiplied(180, 120, 255, 70),
                keyword: Color32::from_rgb(255, 120, 200),
                string: Color32::from_rgb(130, 220, 150),
                comment: Color32::from_rgb(120, 105, 160),
                function: Color32::from_rgb(130, 170, 255),
                number: Color32::from_rgb(255, 180, 100),
                type_name: Color32::from_rgb(100, 220, 240),
            },
            ThemePreset::MidnightBlue => Self {
                background: Color32::from_rgb(10, 15, 35),
                background_secondary: Color32::from_rgb(18, 25, 50),
                surface: Color32::from_rgb(28, 38, 70),
                panel: Color32::from_rgb(18, 25, 50),
                text: Color32::from_rgb(200, 210, 240),
                text_secondary: Color32::from_rgb(160, 175, 215),
                text_muted: Color32::from_rgb(100, 115, 165),
                accent: Color32::from_rgb(80, 140, 255),
                accent_hover: Color32::from_rgb(60, 120, 230),
                success: Color32::from_rgb(100, 220, 140),
                warning: Color32::from_rgb(255, 200, 80),
                error: Color32::from_rgb(255, 90, 90),
                border: Color32::from_rgb(40, 55, 95),
                selection: Color32::from_rgba_premultiplied(80, 140, 255, 70),
                keyword: Color32::from_rgb(200, 120, 255),
                string: Color32::from_rgb(100, 220, 140),
                comment: Color32::from_rgb(100, 115, 165),
                function: Color32::from_rgb(80, 180, 255),
                number: Color32::from_rgb(255, 180, 80),
                type_name: Color32::from_rgb(80, 220, 220),
            },
        }
    }

    pub fn apply(&self, ctx: &egui::Context) {
        let mut style = (*ctx.style()).clone();
        
        // --- Premium Global Style ---
        style.visuals.extreme_bg_color = self.background;
        style.visuals.window_fill = self.surface;
        style.visuals.panel_fill = self.panel;
        style.visuals.code_bg_color = self.background_secondary;
        style.visuals.hyperlink_color = self.accent;
        style.visuals.selection.bg_fill = self.selection;
        style.visuals.selection.stroke.color = self.text;
        style.visuals.window_stroke.color = self.border;
        style.visuals.window_stroke.width = 1.0;
        style.visuals.window_rounding = egui::Rounding::same(12.0);
        
        // Widget states
        style.visuals.widgets.noninteractive.bg_fill = self.surface;
        style.visuals.widgets.noninteractive.fg_stroke.color = self.text;
        style.visuals.widgets.noninteractive.rounding = egui::Rounding::same(8.0);
        
        style.visuals.widgets.inactive.bg_fill = self.background_secondary;
        style.visuals.widgets.inactive.fg_stroke.color = self.text_secondary;
        style.visuals.widgets.inactive.rounding = egui::Rounding::same(8.0);
        
        style.visuals.widgets.hovered.bg_fill = self.surface;
        style.visuals.widgets.hovered.fg_stroke.color = self.text;
        style.visuals.widgets.hovered.rounding = egui::Rounding::same(8.0);
        
        style.visuals.widgets.active.bg_fill = self.accent;
        style.visuals.widgets.active.fg_stroke.color = Color32::WHITE;
        style.visuals.widgets.active.rounding = egui::Rounding::same(8.0);

        // Spacing & Layout
        style.spacing.item_spacing = egui::vec2(10.0, 10.0);
        style.spacing.window_margin = egui::Margin::same(12.0);
        style.spacing.button_padding = egui::vec2(12.0, 6.0);
        style.spacing.interact_size = egui::vec2(40.0, 20.0);

        ctx.set_style(style);
    }
}

pub fn resolve_theme_preset(name: &str) -> ThemePreset {
    match name.to_lowercase().as_str() {
        "dark" => ThemePreset::Dark,
        "tokyo night" | "tokyonight" => ThemePreset::TokyoNight,
        "tokyo night storm" | "tokyonightstorm" => ThemePreset::TokyoNightStorm,
        "dracula" => ThemePreset::Dracula,
        "nord" => ThemePreset::Nord,
        "one dark" | "onedark" => ThemePreset::OneDark,
        "monokai" => ThemePreset::Monokai,
        "solarized dark" | "solarizeddark" => ThemePreset::SolarizedDark,
        "gruvbox dark" | "gruvboxdark" => ThemePreset::GruvboxDark,
        "catppuccin mocha" | "catppuccinmocha" => ThemePreset::CatppuccinMocha,
        "spectral purple" | "spectralpurple" => ThemePreset::SpectralPurple,
        "midnight blue" | "midnightblue" => ThemePreset::MidnightBlue,
        "cyberpunk" => ThemePreset::Cyberpunk,
        "matrix" => ThemePreset::Matrix,
        "light" => ThemePreset::Light,
        "tokyo night day" | "tokyonightday" => ThemePreset::TokyoNightDay,
        "solarized light" | "solarizedlight" => ThemePreset::SolarizedLight,
        "gruvbox light" | "gruvboxlight" => ThemePreset::GruvboxLight,
        "catppuccin latte" | "catppuccinlatte" => ThemePreset::CatppuccinLatte,
        "github light" | "githublight" => ThemePreset::GitHubLight,
        "high contrast dark" | "highcontrastdark" => ThemePreset::HighContrastDark,
        "high contrast light" | "highcontrastlight" => ThemePreset::HighContrastLight,
        _ => ThemePreset::Dark,
    }
}
